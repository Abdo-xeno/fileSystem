<div class="eaton mat-typography" style="overflow-x:hidden; " fxFlexFill cdkScrollable>
	<mat-toolbar color="primary" class="main-header mat-elevation-z4" [class.hidden]="toggleSearch">
		<mat-toolbar-row style="padding: 0 5px;">
    <div style="padding:8px 0 0 10px; flex:1;">
     <div class="mat-title" style="margin-bottom:2px;">File System Manager</div>
     <div class="mat-subheading-2" style="line-height:.6rem;">Please fill the path you want to search for </div>
    </div>
    
    <button mat-icon-button  (click)="openSearch()">
        <mat-icon>search</mat-icon>
    </button>   
  </mat-toolbar-row>
  	</mat-toolbar>

<mat-toolbar class="search-block mat-elevation-z4" [class.active]="toggleSearch">
		<mat-toolbar-row style="padding: 0 5px;">
			<button class="search-icon" mat-icon-button disabled>
        <mat-icon>search</mat-icon>
      </button>
      <input class="search-control" type="text" placeholder="Search" [(ngModel)]="searchText" #searchbar>
      <button mat-button mat-icon-button (click)="searchClose()">
        <mat-icon>close</mat-icon>
      </button>
      <button mat-button mat-icon-button (click)="actionOnPath()">
        <mat-icon>get_app</mat-icon>
      </button> 
  </mat-toolbar-row>
  </mat-toolbar>
</div>


<input type="file" class="file-input"
       (change)="handleFileInput($event.target)" #fileUpload>


<div class="file-upload" >


    <button mat-mini-fab color="primary" class="upload-btn"
      (click)="fileUpload.click()">
        <mat-icon>attach_file</mat-icon>
    </button>
</div>
<div class="file-upload">


 


<ngx-graph
  class="chart-container"
  [view]="[1500, 1500]"
  [showMiniMap]="true"
  [links]=links
  [nodes]=initialNodes
  [zoomToFit$]="zoomToFit$"
  [update$]="update$"
  [center$]="center$"
  

>
<ng-template #nodeTemplate let-node>
  
  <svg:g class="node" xmlns="http://www.w3.org/2000/xhtml">
    <svg:foreignObject width="300" height="40">
      <xhtml:div class="cardContainer">
        <label>{{ node.label }}</label>
        <button mat-icon-button [matMenuTriggerFor]="menu" aria-label="Example icon-button with a menu">
          <mat-icon>more_vert</mat-icon>
        </button>
        <mat-menu #menu="matMenu">
          <button *ngIf="node.type == 'file'" mat-menu-item (click)="onNodeSelected(node)">
            <mat-icon>arrow_downward</mat-icon>
            <span>Download file</span>
          </button>
            <button *ngIf="node.type == 'directory'" mat-menu-item (click)="fileUpload.click() ; uploadFileToActivity(node)">
              <mat-icon>insert_drive_file</mat-icon>
              <span>Add File</span>
            </button>

            
           
          
          <button *ngIf="node.type == 'directory'" mat-menu-item (click)="addNewFolder(node)">
            <mat-icon>create_new_folder</mat-icon>
            <span>Add Folder</span>
          </button>
          <button *ngIf="node.type == 'directory'" mat-menu-item (click)="onNodeSelected(node)">
            <mat-icon>folder_open</mat-icon>
            <span>Open directory</span>
          </button>
          <button *ngIf="node.type == 'directory'" mat-menu-item (click)="addLink(node)">
            <mat-icon>link</mat-icon>
            <span>Add Link</span>
          </button>
          <button mat-menu-item (click)="displayProperties(node)">
            <mat-icon>info</mat-icon>
            <span>Properties</span>
          </button>
        </mat-menu>
      </xhtml:div>
    </svg:foreignObject>
  </svg:g>
</ng-template>

<ng-template #linkTemplate let-link>
  <svg:g class="edge" >
    <svg:path class="line" stroke-width="2" stroke="#bebebe" stroke-dasharray="2,2" marker-end="url(#arrow)" >
    </svg:path>

    <svg:text class="edge-label" text-anchor="middle">
      <textPath class="text-path" [attr.href]="'#' + link.id" style="fill: #4c4c4c;" [style.dominant-baseline]="link.dominantBaseline"
        startOffset="50%">
        {{link.label}}
      </textPath>
    </svg:text>
  </svg:g>
</ng-template>






</ngx-graph>